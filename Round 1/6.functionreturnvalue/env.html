<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <title>Intro To Programming</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/4.7.1/pixi.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.11/lodash.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/brython/3.7.1/brython.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/brython/3.7.1/brython_stdlib.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pako/1.0.10/pako.js"></script>
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="0">
</head>

<body onload="brython();">

    <div id="env"></div>
    
    <script>
        var mapObj = {
            "cars": [],
            "asset": [{
                "x": 69.83203125,
                "y": 68.83984375
            }],
            "road": [{
                "x": 240,
                "y": 660
            },
            {
                "x": 240,
                "y": 600
            },
            {
                "x": 240,
                "y": 540
            },
            {
                "x": 240,
                "y": 480
            },
            {
                "x": 240,
                "y": 420
            },
            {
                "x": 240,
                "y": 360
            },
            {
                "x": 240,
                "y": 300
            },
            {
                "x": 240,
                "y": 240
            },
            {
                "x": 240,
                "y": 180
            },
            {
                "x": 240,
                "y": 120
            },
            {
                "x": 240,
                "y": 60
            },
            {
                "x": 240,
                "y": 0
            }
            ],
            "map": [
                [
                    0,
                    0,
                    0,
                    0,
                    "↕",
                    0,
                    0,
                    0,
                    0
                ],
                [
                    0,
                    0,
                    0,
                    0,
                    "↕",
                    0,
                    0,
                    0,
                    0
                ],
                [
                    0,
                    0,
                    0,
                    0,
                    "↕",
                    0,
                    0,
                    0,
                    0
                ],
                [
                    0,
                    0,
                    0,
                    0,
                    "↕",
                    0,
                    0,
                    0,
                    0
                ],
                [
                    0,
                    0,
                    0,
                    0,
                    "↕",
                    0,
                    0,
                    0,
                    0
                ],
                [
                    0,
                    0,
                    0,
                    0,
                    "↕",
                    0,
                    0,
                    0,
                    0
                ],
                [
                    0,
                    0,
                    0,
                    0,
                    "↕",
                    0,
                    0,
                    0,
                    0
                ],
                [
                    0,
                    0,
                    0,
                    0,
                    "↕",
                    0,
                    0,
                    0,
                    0
                ]
            ],
            "agent": {
                "mx": 4,
                "my": 0,
                "line": 0,
                "motion": {
                    "type": "BasicMotionEngine",
                    "options": {
                        "rotationStep": 0.5,
                        "actions": [
                            "UP",
                            "LEFT",
                            "RIGHT",
                            "DOWN",
                            "WAIT"
                        ]
                    }
                }
            }
        };
    </script>
    <script src="https://cdn.jsdelivr.net/combine/npm/metacar@0.1.1,npm/metacar@0.1.1"></script>
    <script>
        // Select a level
        const level = metacar.level.level1;
        // Create the environement
        var env = new metacar.env("env", mapObj);


        // Load it
        env.load().then(() => {
            loadParams()
        })

    </script>

    


    <!-- <script src="run.py" type="text/python"></script> -->

</body>

<script>
    function loadParams() {
        var urlParams = new URLSearchParams(window.location.search);
        var codeInput = urlParams.get('action')
        if (codeInput) {    
            let gzippedSrc = decodeURIComponent(codeInput);
            let parsedCode = pako.ungzip(atob(gzippedSrc), { to: 'string' });
            let code = __BRYTHON__.python_to_js(parsedCode)
            eval(code)
        }

    }
        
    </script>

</html>